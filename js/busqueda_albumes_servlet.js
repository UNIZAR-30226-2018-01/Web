$(document).ready(function(){var a=window.location.href,e=new URL(a),t=e.searchParams.get("pagina");null==t&&(t=1);var n=e.searchParams.get("busqueda_album");null==n&&(window.location="home.html"),document.title="Búsqueda álbumes: "+n,$("#texto_nombre_busqueda").append('"'+n+'"');var r=JSON.parse(JSON.parse(sessionStorage.getItem("lista_albumes"))).albums;if(null!=r){var o=20*(t-1),s=1;for(i=o;i<20+o&&i<r.length;i++){var l=r[i].nombre,u=r[i].artista,m=r[i].ruta_imagen,d=m.indexOf("/ps"),b='<li id="barraopciones"> <div class="cancioninf"><a href="album.html?album='+l+"&artista="+u+'" id="enlacecancion"><div class="imagen"><img src="'+(".."+m.substr(d))+'" alt="Imagen cancion" onerror="this.src=\'img/Unknown_Album.png\'"></div><div class="nombrecancion">'+l+"</div></a></div></li>";$("#lista_albumes").append(b),s=0}if(1==s)$("#titulopagina").after('<h2 id="sin_resul">No hay resultados.</h2>');else if(20+o<r.length){var c='<br><br><form action="busqueda_albumes.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="busqueda_album" value="'+n+'"/><input type="hidden" name="pagina" value="'+(t+1)+'"/></form>';$(".informacion").append(c)}}else $("#titulopagina").after('<h2 id="sin_resul">No hay resultados.</h2>');$("#form_buscar_album").submit(function(a){a.preventDefault();var e=document.getElementById("form_buscar_album").elements[0].value,i=$.trim(e);if(document.getElementById("search_album").value=i,""==i)return!1;var t=$(this).attr("action"),n=$(this).serialize(),r=$(this).attr("method");$.ajax({url:t,type:r,data:n}).done(function(a){var e=JSON.parse(a),t=JSON.stringify(a);null!=e.error?e.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):e.error.indexOf("album cuyo nombre sea o empiece")>=0?(sessionStorage.setItem("lista_albumes",t),window.location="busqueda_albumes.html?busqueda_album="+i+"&pagina=1"):alert("Error. Inténtelo más tarde."):(sessionStorage.setItem("lista_albumes",t),window.location="busqueda_albumes.html?busqueda_album="+i+"&pagina=1")}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})})});

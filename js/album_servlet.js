function mostrarAlbumconFav(a,e){var r=window.location.href,n=new URL(r),t=n.searchParams.get("pagina"),o=n.searchParams.get("artista"),s=n.searchParams.get("album"),l=a.canciones,m=JSON.stringify(l);sessionStorage.setItem("listaAux",m);var u=e;t=null==t?1:parseInt(t);for(inicio=4*(t-1),i=inicio;i<4+inicio&&i<l.length;i++){var d,c,p,b,f=l[i].tituloCancion,_=l[i].nombreArtista,v=l[i].genero,g=l[i].nombreAlbum,h=l[i].ruta,y=h.indexOf("/ps"),w=".."+h.substr(y),I=l[i].uploader,C=l[i].ruta_imagen,A=C.indexOf("/ps"),O=".."+C.substr(A);null==v&&(v=""),null==g&&(g=""),1==(null!=u&&u.includes(JSON.stringify(l[i])))?(d="QuitarCancionDeLista",c="favanadido.png",p="Quitar de favoritos",b="form_quitar_favorito"):(d="AnyadirCancionALista",c="favoritos.png",p="Añadir a favoritos",b="form_poner_favorito");var S='<div class="cancioninf"><ul><li id="barraopciones"><a href="cancion.html?nombre='+f+"&artista="+_+"&album="+g+"&genero="+v+"&uploader="+I+"&ruta="+w+"&ruta_imagen="+O+'" id="enlacecancion"><div class="imagen"><img src="'+O+'" alt="Imagen cancion" onClick="setIndiceAndPlay('+i+',1)" onerror="this.src=\'img/Unknown_Music.png\'"></div></a></li>',k='<li id="barraopciones"><a href="cancion.html?nombre='+f+"&artista="+_+"&album="+g+"&genero="+v+"&uploader="+I+"&ruta="+w+"&ruta_imagen="+O+'" id="enlacecancion"><div class="nombrecancion" onClick="setIndiceAndPlay('+i+',1)">'+f+"</div></a></li>",x='<li id="barraopciones"><div class="simb_repr_play"><input type="image" src="img/play.png" alt="Reproducir cancion" title="Reproducir canción" onClick="setIndiceAndPlay('+i+',0);return false;"></div></li>',N='<form class="'+b+'" method="post" action="/ps/'+d+'"><li id="barraopciones"><div class="simb_repr_fav"><input type="image" src="img/'+c+'" alt="'+p+'" title="'+p+'"></div><input type="hidden" name="ruta" value="'+h+'"/><input type="hidden" name="nombreLista" value="Favoritos"/></li></form>',P='<form class="form_mostrar_listas_c" method="post" action="/ps/MostrarListasReproduccion"><li id="barraopciones"><div class="simb_repr_lista"><div class="simb_repr_lista"><input type="hidden" id="user" name="user" value="'+leerCookie("login")+'"><input type="hidden" name="ruta" value="'+h+'"/><input type="image" src="img/listas_add.png" alt="Añadir a lista" class="boton_mostrar_listas" title="Añadir a lista"></div></div></li></form>';$(".informacion").append(S+k+x+N+P+"</ul></div>")}if(4+inicio<l.length){var E='<br><br><form action="album.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="album" value="'+s+'"/><input type="hidden" name="artista" value="'+o+'"/><input type="hidden" name="pagina" value="'+(t+1)+'"/></form>';$(".informacion").append(E)}form_mostrar_anadir_alistas(),form_anadirquitar_cancion_a_favorito()}$(document).ready(function(){var a=window.location.href,e=new URL(a),r=e.searchParams.get("album");null==r&&(window.location="home.html"),$("#texto_nombre_busqueda").append(n);var n=e.searchParams.get("artista");null==n&&(window.location="home.html"),document.getElementById("artista_del_album").href="artista.html?artista="+n,$("#titulo_artista").append(n),document.title="Álbum "+r+" de "+n,$("#form_buscar_album").submit(function(a){a.preventDefault();var i=document.getElementById("form_buscar_album").elements[0].value,e=$.trim(i);if(document.getElementById("search_album").value=e,""==e)return!1;var r=$(this).attr("action"),n=$(this).serialize(),t=$(this).attr("method");$.ajax({url:r,type:t,data:n}).done(function(a){var i=JSON.parse(a),r=JSON.stringify(a);null!=i.error?i.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):i.error.indexOf("album cuyo nombre sea o empiece")>=0?(sessionStorage.setItem("lista_albumes",r),window.location="busqueda_albumes.html?busqueda_album="+e+"&pagina=1"):alert("Error. Inténtelo más tarde."):(sessionStorage.setItem("lista_albumes",r),window.location="busqueda_albumes.html?busqueda_album="+e+"&pagina=1")}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_album").submit(function(a){a.preventDefault();var e=window.location.href,r=new URL(e),n=r.searchParams.get("album"),t=r.searchParams.get("artista");document.getElementById("form_mostrar_album").elements[0].value=n,document.getElementById("form_mostrar_album").elements[1].value=t;var o=$(this).attr("action"),s=$(this).serialize(),l=$(this).attr("method");$.ajax({url:o,type:l,data:s}).done(function(a){var e=JSON.parse(a);null!=e.error?e.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):null!=e.NoHayCanciones?$("#artista_del_album").after('<h2 id="sin_resul">No hay canciones.</h2>'):cargar_lista_favoritos().done(function(a){var r=JSON.parse(a),n=void 0;if(null!=r.error)r.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html");else if(null!=r.NoHayCanciones);else{var t=r.canciones;if(t.length>0){for(i in t)delete t[i].uploader;n=JSON.stringify(t)}}mostrarAlbumconFav(e,n)}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_album").submit()});

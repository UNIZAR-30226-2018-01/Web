function form_mostrar_usuario(){$("#form_seguir_usuario").submit(function(i){i.preventDefault();var a=$(this).attr("action"),r=$(this).serialize(),e=$(this).attr("method"),o=r.slice(8);$.ajax({url:a,type:e,data:r}).done(function(i){var a=JSON.parse(i);null!=a.error?a.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):($("#resultado_seguir").text("Ya estas siguiendo a "+o+"."),$("#result_seguir").attr("src","img/error.png")):($("#resultado_seguir").text("Usuario añadido como amigo."),$("#result_seguir").attr("src","img/exito.png")),$(".button1").click()}).fail(function(i){alert("Error interno. Inténtelo más tarde.")})})}$(document).ready(function(){var a=window.location.href,r=new URL(a),e=r.searchParams.get("usuario");null==e&&(window.location="perfil.html"),$("#titulopagina").append("<h1>"+e+"</h1>");var o,t=r.searchParams.get("pagina");document.title="Usuario: "+e,$("#form_buscar_amigos").submit(function(i){i.preventDefault();var a=document.getElementById("form_buscar_amigos").elements[0].value,r=$.trim(a);if(document.getElementById("search_user").value=r,""==r)return!1;var e=$(this).attr("action"),o=$(this).serialize(),t=$(this).attr("method");$.ajax({url:e,type:t,data:o}).done(function(i){var a=JSON.parse(i),e=JSON.stringify(i);null!=a.error?a.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):(sessionStorage.setItem("lista_usuarios",e),window.location="usuarios.html?busqueda_usuario="+r+"&pagina=1")}).fail(function(i){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_usuario").submit(function(a){a.preventDefault(),document.getElementById("form_mostrar_usuario").elements[0].value=e;var r=$(this).attr("action"),n=$(this).serialize(),s=$(this).attr("method");$.ajax({url:r,type:s,data:n}).done(function(a){var r=JSON.parse(a);if(null!=r.error){var n=r.error,s="../ps/images/"+e+".jpg";if(n.indexOf("no sigue a")>=0){var u='<div class="imagen"><img src="'+s+'" alt="Imagen usuario" onerror="this.src=\'img/user.png\'"></div>';$("#titulopagina").after(u),leerCookie("login")!=e&&(u='<form id="form_seguir_usuario" method="post" action="/ps/SeguirUsuario"><div class="anadir_lista"><input type="image" src="img/add_friend.png" alt="Añadir amigo" title="Añadir amigo"></div><input type="hidden" id="seguido" name="seguido" value="'+e+'"/></form>',$("#titulopagina").after(u)),u="No puedes ver las listas porque no lo sigues.",$(".block1").append(u)}else if(n.indexOf("no tiene ninguna lista asociada")>=0){u='<div class="imagen"><img src="'+s+'" alt="Imagen usuario" onerror="this.src=\'img/user.png\'"></div>';$("#titulopagina").after(u),leerCookie("login")!=e&&(u='<form id="form_seguir_usuario" method="post" action="/ps/SeguirUsuario"><div class="anadir_lista"><input type="image" src="img/add_friend.png" alt="Añadir amigo" title="Añadir amigo"></div><input type="hidden" id="seguido" name="seguido" value="'+e+'"/></form>',$("#titulopagina").after(u))}else r.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):$("#titulopagina").after('<h2 id="sin_resul">No existe el usuario.</h2>')}else{u='<div class="imagen"><img src="'+(s="../ps/images/"+e+".jpg")+'" alt="Imagen usuario" onerror="this.src=\'img/user.png\'"></div>';$("#titulopagina").after(u),leerCookie("login")!=e&&(u='<form id="form_seguir_usuario" method="post" action="/ps/SeguirUsuario"><div class="anadir_lista"><input type="image" src="img/add_friend.png" alt="Añadir amigo" title="Añadir amigo"></div><input type="hidden" id="seguido" name="seguido" value="'+e+'"/></form>',$("#titulopagina").after(u));var l=r.nombre;for(t=null==t?1:parseInt(t),o=4*(t-1),i=o;i<4+o&&i<l.length;i++){var d=l[i];if("Favoritos"!=d){var m='<div class="cancioninf"><ul><li id="barraopciones"><a href="lista.html?lista='+d+"&autor="+e+'" id="enlacecancion"><div class="imagen"><img src="img/listaicono.png" alt="Imagen lista"></div></a></li>',g='<li id="barraopciones"><form class="form_reproducir_lista" method="post" action="/ps/VerLista"><div class="simb_repr_play"><input type="image" src="img/play.png" alt="Reproducir lista" title="Reproducir lista"><input type="hidden" name="nombreLista" value="'+d+'"/><input type="hidden" name="nombreCreadorLista" value="'+e+'"/></div></form></li>',p='<li id="barraopciones"><a href="lista.html?lista='+d+"&autor="+e+'"><div class="nombrecancion">'+d+"</div></a></li></ul></div>";$(".block1").append(m+g+p)}}if(4+o<l.length){var c='<br><br><form action="usuario.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="usuario" value="'+e+'"/><input type="hidden" name="pagina" value="'+(t+1)+'"/></form>';$(".informacion").append(c)}form_repr_lista()}form_mostrar_usuario()}).fail(function(i){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_usuario").submit()});

function mostrarBusquedaconFav(a,n){var r=window.location.href,e=new URL(r),o=e.searchParams.get("busqueda_cancion"),t=a.canciones,s=parseInt(e.searchParams.get("pagina")),l=n,c=5*((s=null==s?1:parseInt(s))-1);for(i=c;i<5+c&&i<t.length;i++){var d,u,m,p,f=t[i].tituloCancion,v=t[i].nombreArtista,g=t[i].genero,_=t[i].nombreAlbum,b=t[i].ruta,h=b.indexOf("/ps"),y=".."+b.substr(h),A=t[i].uploader,w=t[i].ruta_imagen,q=w.indexOf("/ps"),C=".."+w.substr(q);null==g&&(g=""),null==_&&(_=""),1==(null!=l&&l.includes(JSON.stringify(t[i])))?(d="QuitarCancionDeLista",u="favanadido.png",m="Quitar de favoritos",p="form_quitar_favorito"):(d="AnyadirCancionALista",u="favoritos.png",m="Añadir a favoritos",p="form_poner_favorito");var I='<div class="cancioninf"><ul><li id="barraopciones"><a href="cancion.html?nombre='+f+"&artista="+v+"&album="+_+"&genero="+g+"&uploader="+A+"&ruta="+y+"&ruta_imagen="+C+'" id="enlacecancion"><div class="imagen"><img src="'+C+'" alt="Imagen cancion" onClick="setIndiceAndPlay('+i+',1)" onerror="this.src=\'img/Unknown_Music.png\'"></div></a></li>',O='<li id="barraopciones"><a href="cancion.html?nombre='+f+"&artista="+v+"&album="+_+"&genero="+g+"&uploader="+A+"&ruta="+y+"&ruta_imagen="+C+'" id="enlacecancion"><div class="nombrecancion" onClick="setIndiceAndPlay('+i+',1)">'+f+'</div></a><a href="artista.html?artista='+v+'" id="enlacecancion"><div class="nombreautor">Artista: '+v+"</div></a></li>",S='<li id="barraopciones"><div class="simb_repr_play"><input type="image" src="img/play.png" alt="Reproducir cancion" title="Reproducir canción" onClick="setIndiceAndPlay('+i+',0);return false;"></div></li>',N='<form class="'+p+'" method="post" action="/ps/'+d+'"><li id="barraopciones"><div class="simb_repr_fav"><input type="image" src="img/'+u+'" alt="'+m+'" title="'+m+'"></div><input type="hidden" name="ruta" value="'+b+'"/><input type="hidden" name="nombreLista" value="Favoritos"/></li></form>',k='<form class="form_mostrar_listas_c" method="post" action="/ps/MostrarListasReproduccion"><li id="barraopciones"><div class="simb_repr_lista"><div class="simb_repr_lista"><input type="hidden" id="user" name="user" value="'+leerCookie("login")+'"><input type="hidden" name="ruta" value="'+b+'"/><input type="image" src="img/listas_add.png" alt="Añadir a lista" class="boton_mostrar_listas" title="Añadir a lista"></div></div></li></form>';$(".informacion").append(I+O+S+N+k+"</ul></div>")}if(5+c<t.length){var J='<br><br><form action="busqueda.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="busqueda_cancion" value="'+o+'"/><input type="hidden" name="pagina" value="'+(s+1)+'"/></form>';$(".informacion").append(J)}form_mostrar_anadir_alistas(),form_anadirquitar_cancion_a_favorito()}$(document).ready(function(){var a=window.location.href,n=new URL(a).searchParams.get("busqueda_cancion");null==n&&(window.location="home.html"),$("#texto_nombre_busqueda").append('"'+n+'"');var r=JSON.parse(JSON.parse(sessionStorage.getItem("lista_canciones")));if(null==r)return!1;document.title="Búsqueda canciones: "+n;var e=r.canciones;if(null!=e){var o=JSON.stringify(e);sessionStorage.setItem("listaAux",o),cargar_lista_favoritos().done(function(a){var n=JSON.parse(a),e=void 0;if(null!=n.error)n.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html");else if(null!=n.NoHayCanciones);else{var o=n.canciones;if(o.length>0){for(i in o)delete o[i].uploader;e=JSON.stringify(o)}}mostrarBusquedaconFav(r,e)}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}else $("#titulopagina").after('<h2 id="sin_resul">No hay resultados.</h2>')});

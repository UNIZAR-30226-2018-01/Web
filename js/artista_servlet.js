var url_string=window.location.href,url=new URL(url_string),artista=url.searchParams.get("artista");null==artista&&(window.location="home.html"),$(document).ready(function(){var a=window.location.href,t=new URL(a).searchParams.get("artista"),r=$.trim(t);$("#nombre_artista_titulo").append(r),document.title="Artista "+r,$("#form_mostrar_albumes_artista").submit(function(a){a.preventDefault(),document.getElementById("nombre_artista_album").value=r;var t=$(this).attr("action"),e=$(this).serialize(),n=$(this).attr("method");$.ajax({url:t,type:n,data:e}).done(function(a){var t=JSON.parse(a);if(null!=t.error)t.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html");else{var r=t.albums;if(r.length>0){$("#titulopagina").after('<div id="titulopagina"><h3>Álbumes</h3></div><div class="albumes"><ul id="lista_albumes"></ul></div>');var e=window.location.href,n=new URL(e).searchParams.get("artista"),o=$.trim(n);for(i=0;i<r.length;i++){var s=r[i].nombre,l=r[i].ruta_imagen,u=l.indexOf("/ps"),c='<li id="barraopciones"> <div class="cancioninf"><a href="album.html?album='+s+"&artista="+o+'" id="enlacecancion"><div class="imagen"><img src="'+(".."+l.substr(u))+'" alt="Imagen album" onerror="this.src=\'img/Unknown_Album.png\'"></div><div class="nombrecancion">'+s+"</div></a></div></li>";$("#lista_albumes").append(c)}}}}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_albumes_artista").submit(),$("#form_mostrar_canciones_artista").submit(function(a){a.preventDefault(),document.getElementById("nombre_artista_cancion").value=r;var t=$(this).attr("action"),e=$(this).serialize(),n=$(this).attr("method");$.ajax({url:t,type:n,data:e}).done(function(a){var t=JSON.parse(a);if(null!=t.error)t.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html");else{var r=t.canciones,e=JSON.stringify(r);if(sessionStorage.setItem("listaAux",e),r.length>0){for($("#separador_album_cancion").after('<div id="tituloestilo"><h3>Canciones</h3></div><div class="cancionesArtista"><ul id="lista_canciones_artista"></ul></div>'),i=0;i<r.length;i++){var n=r[i].tituloCancion,o=r[i].nombreArtista,s=r[i].genero,l=r[i].nombreAlbum,u=r[i].ruta,c=u.indexOf("/ps"),d=".."+u.substr(c),m=r[i].uploader,b=r[i].ruta_imagen,f=b.indexOf("/ps"),v=".."+b.substr(f);null==s&&(s=""),null==l&&(l="");var _='<li id="barraopciones"><div class="cancioninf"><a href="cancion.html?nombre='+n+"&artista="+o+"&album="+l+"&genero="+s+"&uploader="+m+"&ruta="+d+"&ruta_imagen="+v+'" id="enlacecancion"><div class="imagen"><img src="'+v+'" alt="Imagen cancion" onClick="setIndiceAndPlay('+i+',1)" onerror="this.src=\'img/Unknown_Music.png\'"></div><div class="nombrecancion" onClick="setIndiceAndPlay('+i+',1)">'+n+"</div></a></div></li>";$("#lista_canciones_artista").append(_)}}}}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_canciones_artista").submit(),$("#form_buscar_artista").submit(function(a){a.preventDefault();var i=document.getElementById("form_buscar_artista").elements[0].value,t=$.trim(i);if(document.getElementById("search_artista").value=t,""==t)return!1;var r=$(this).attr("action"),e=$(this).serialize(),n=$(this).attr("method");$.ajax({url:r,type:n,data:e}).done(function(a){var i=JSON.parse(a),r=JSON.stringify(a);null!=i.error?i.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):i.error.indexOf("artista cuyo nombre sea o empiece")>=0?(sessionStorage.setItem("lista_usuarios",lista_usuarios),window.location="busqueda_artistas.html?busqueda_artista="+t+"&pagina=1"):alert("Error. Inténtelo más tarde."):(sessionStorage.setItem("lista_artistas",r),window.location="busqueda_artistas.html?busqueda_artista="+t+"&pagina=1")}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})})});

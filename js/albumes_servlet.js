$(document).ready(function(){var a,e=window.location.href,r=new URL(e).searchParams.get("pagina");document.title="Álbumes",$("#form_mostrar_albumes").submit(function(e){e.preventDefault();var t=$(this).attr("action"),n=$(this).serialize(),o=$(this).attr("method");$.ajax({url:t,type:o,data:n}).done(function(e){var t=JSON.parse(e);if(null!=t.error)t.error.indexOf("Usuario no logeado en el servidor")>=0&&(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html");else{var n=JSON.stringify(e);sessionStorage.setItem("lista_albumes",n);var o=t.albums;for(r=null==r?1:parseInt(r),a=20*(r-1),i=a;i<20+a&&i<o.length;i++){var s=o[i].nombre,l=o[i].artista,m=o[i].ruta_imagen,u=m.indexOf("/ps"),d='<li id="barraopciones"> <div class="cancioninf"><a href="album.html?album='+s+"&artista="+l+'" id="enlacecancion"><div class="imagen"><img src="'+(".."+m.substr(u))+'" alt="Imagen cancion" onerror="this.src=\'img/Unknown_Album.png\'"></div><div class="nombrecancion">'+s+"</div></a></div></li>";$("#lista_albumes").append(d)}if(20+a<o.length){var b='<br><br><form action="albumes.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="pagina" value="'+(r+1)+'"/></form>';$(".informacion").append(b)}}}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_albumes").submit(),$("#form_buscar_album").submit(function(a){a.preventDefault();var e=document.getElementById("form_buscar_album").elements[0].value,r=$.trim(e);if(document.getElementById("search_album").value=r,""==r)return!1;var i=$(this).attr("action"),t=$(this).serialize(),n=$(this).attr("method");$.ajax({url:i,type:n,data:t}).done(function(a){var e=JSON.parse(a),i=JSON.stringify(a);null!=e.error?e.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):e.error.indexOf("album cuyo nombre sea o empiece")>=0?(sessionStorage.setItem("lista_albumes",i),window.location="busqueda_albumes.html?busqueda_album="+r+"&pagina=1"):alert("Error. Inténtelo más tarde."):(sessionStorage.setItem("lista_albumes",i),window.location="busqueda_albumes.html?busqueda_album="+r+"&pagina=1")}).fail(function(a){alert("Error interno. Inténtelo más tarde.")})})});

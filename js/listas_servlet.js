function form_borrar_lista(){$(".form_borrar_lista").submit(function(r){r.preventDefault();var i=$(this).attr("action"),t=$(this).serialize(),a=$(this).attr("method");t.slice(12);$.ajax({url:i,type:a,data:t}).done(function(r){var i=JSON.parse(r);null!=i.error?i.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):alert("Error interno. Inténtelo más tarde."):($("#resultado_seguir").text("Lista eliminada correctamente."),$("#result_seguir").attr("src","img/exito.png")),$(".button1").click()}).fail(function(r){alert("Error interno. Inténtelo más tarde.")})})}$(document).ready(function(){var r,t=window.location.href,a=new URL(t).searchParams.get("pagina");document.title="Listas",$("#form_mostrar_listas").submit(function(t){t.preventDefault(),document.getElementById("form_mostrar_listas").elements[0].value=leerCookie("login");var e=$(this).attr("action"),o=$(this).serialize(),n=$(this).attr("method");$.ajax({url:e,type:n,data:o}).done(function(t){var e=JSON.parse(t);if(null!=e.error)e.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):$("#anadir_lista").after('<h2 id="sin_resul">No hay listas.</h2>');else{var o=e.nombre;a=null==a?1:parseInt(a),r=5*(a-1);var n=1,s=leerCookie("login");for(i=r;i<5+r&&i<o.length;i++){var l=o[i];if("Favoritos"!=l){var d='<div class="cancioninf"><ul><li id="barraopciones"><a href="lista.html?lista='+l+"&autor="+s+'" id="enlacecancion"><div class="imagen"><img src="img/listaicono.png" alt="Imagen lista"></div></a></li><li id="barraopciones"><a href="lista.html?lista='+l+"&autor="+s+'"><div class="nombrecancion">'+l+"</div></a></li>",m='<li id="barraopciones"><form class="form_reproducir_lista" method="post" action="/ps/VerLista"><div class="simb_repr_play"><input type="image" src="img/play.png" alt="Reproducir lista" title="Reproducir lista"><input type="hidden" name="nombreLista" value="'+l+'"/><input type="hidden" name="nombreCreadorLista" value="'+s+'"/></div></form></li>',u='<li id="barraopciones"><form class="form_borrar_lista" method="post" action="/ps/BorrarListaDeReproduccion"><div class="simb_repr_elim"><input type="image" src="img/eliminar.png" alt="Eliminar lista" title="Eliminar lista"></div><input type="hidden" id="seguido" name="nombreLista" value="'+l+'"/></form></li></ul></div>';$(".informacion").append(d+m+u),n=0}}if(1==n&&$("#anadir_lista").after('<h2 id="sin_resul">No hay listas.</h2>'),5+r<o.length){var c='<br><br><form action="listas.html"><button type="submit" id="boton_mostrar_mas" class="aumentar">Mostrar más</button><input type="hidden" name="pagina" value="'+(a+1)+'"/></form>';$(".informacion").append(c)}}form_borrar_lista(),form_repr_lista()}).fail(function(r){alert("Error interno. Inténtelo más tarde.")})}),$("#form_mostrar_listas").submit(),$("#form_crear_lista").submit(function(r){r.preventDefault();var i=document.getElementById("form_crear_lista").elements[0].value,t=$.trim(i);if(document.getElementById("IdUsar").value=t,""==t)return!1;var a=$(this).attr("action"),e=$(this).serialize(),o=$(this).attr("method");$.ajax({url:a,type:o,data:e}).done(function(r){var i=JSON.parse(r);null!=i.error?i.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):($("#resultado_seguir").text("Ya existe la lista "+t+"."),$("#result_seguir").attr("src","img/error.png")):($("#resultado_seguir").text("Lista creada correctamente."),$("#result_seguir").attr("src","img/exito.png")),$(".button1").click()}).fail(function(r){alert("Error interno. Inténtelo más tarde.")})}),$("#form_buscar_lista").submit(function(r){r.preventDefault();var i=document.getElementById("form_buscar_lista").elements[0].value,t=$.trim(i);if(document.getElementById("search_lista").value=t,""==t)return!1;var a=$(this).attr("action"),e=$(this).serialize(),o=$(this).attr("method");$.ajax({url:a,type:o,data:e}).done(function(r){var i=JSON.parse(r),a=JSON.stringify(r);null!=i.error?i.error.indexOf("Usuario no logeado en el servidor")>=0?(borrarCookie("login"),borrarCookie("idSesion"),window.location="inicio.html"):i.error.indexOf("lista cuyo nombre coincida")>=0?(sessionStorage.setItem("lista_listas",a),window.location="busqueda_listas.html?busqueda_lista="+t+"&pagina=1"):alert("Error. Inténtelo más tarde."):(sessionStorage.setItem("lista_listas",a),window.location="busqueda_listas.html?busqueda_lista="+t+"&pagina=1")}).fail(function(r){alert("Error interno. Inténtelo más tarde.")})})});
